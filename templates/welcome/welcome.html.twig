{% extends 'base.html.twig' %}

{% block title %}Hawkins - Intro Immersive{% endblock %}

{% block stylesheets %}
<style>
html, body {
    margin:0; padding:0; width:100%; height:100%;
    font-family: 'ITC Benguiat Std', serif;
    background: url('/images/fondRouge.png') center/cover no-repeat;
    color:white; overflow:hidden;
}

/* FenÃªtre immersive */
.intro-window {
    position:absolute;
    top:50%; left:50%;
    transform:translate(-50%, -50%);
    background: rgba(0,0,0,0.8);
    padding: 30px 40px;
    border-radius: 15px;
    max-width:800px;
    text-align:center;
    box-shadow: 0 0 30px black;
    opacity:0;
    transition: opacity 2s ease;
}

.intro-text {
    font-size:20px;
    line-height:1.3; /* plus serrÃ© */
    margin-bottom:25px;
}

.intro-text p {
    margin:5px 0; /* rÃ©duire l'espace entre paragraphes */
}

/* Logo plus grand */
.intro-text .logo-large {
    width:330px; /* agrandi pour bien le voir */
    margin-bottom:10px;
}

/* Bouton Let's Go */
#start-btn {
    padding:12px 28px;
    font-size:20px;
    border:none;
    border-radius:8px;
    background:gold;
    color:black;
    cursor:pointer;
    transition: transform 0.2s;
}
#start-btn:hover { transform: scale(1.05); }

/* FantÃ´mes interactifs */
.ghost-link {
    position:absolute;
    cursor:pointer;
    opacity:0;
    transition: opacity 2s ease;
    font-size:18px;
}

/* Exemple positions fantÃ´mes */
#ghost-monstre { top:40%; left:10%; }
#ghost-doc { top:60%; right:15%; }
#ghost-lampe { top:20%; left:70%; }

/* Message fantÃ´me */
.game-message {
    position:fixed;
    top:50%; left:50%;
    transform:translate(-50%, -50%);
    background:rgba(0,0,0,0.7);
    padding:20px 40px;
    border-radius:10px;
    font-size:1.5rem;
    opacity:0;
    text-shadow:2px 2px 8px black;
    transition:opacity 1s;
    pointer-events:none;
    z-index:1000;
}

/* Formulaire mot de passe */
#password-form {
    display:none;
    flex-direction:column;
    align-items:center;
    gap:10px;
    position:absolute;
    top:50%; left:50%;
    transform:translate(-50%, -50%);
    opacity:0;
    transition: opacity 1s ease;
}
#password-form input {
    padding:12px 16px; font-size:16px;
    border-radius:8px; border:1px solid rgba(255,255,255,0.3);
    background: rgba(0,0,0,0.5); color:white; text-align:center;
}
#password-form button {
    padding:10px 20px; border:none; border-radius:5px;
    background:gold; color:black; cursor:pointer;
}
</style>
{% endblock %}

{% block body %}
<div class="intro-window" id="intro-window">
    <div class="intro-text">
        <img src="/images/logo.png" alt="Logo Hawkins" class="logo-large">
        <p>Hawkins est en danger !</p>
        <p>Une faille vers le Monde Ã  lâ€™Envers sâ€™est ouverte dans le laboratoire.</p>
        <p>Des crÃ©atures sâ€™Ã©chappent et des documents secrets ont Ã©tÃ© volÃ©s.</p>
        <p>Vous, membres du groupe dâ€™Ã©lÃ¨ves courageux, devez retrouver les codes pour refermer la failleâ€¦</p>
        <p><strong>avant que le Monde Ã  lâ€™Envers nâ€™envahisse Hawkins !</strong></p>
    </div>
    <butto id="start-btn">Let's Go !</button>
</div>

<!-- FantÃ´mes interactifs -->
<div id="ghost-monstre" class="ghost-link">
    <img src="/images/monstre.webp" alt="Monstre" style="width:320px; height:auto;">
</div>
<div id="ghost-doc" class="ghost-link">ðŸ“„</div>
<div id="ghost-lampe" class="ghost-link">ðŸ’¡</div>

<!-- Formulaire mot de passe (cachÃ©) -->
<form id="password-form" method="post" action="{{ path('app_welcome') }}" data-password="ChambreDeWill">
    <input id="password" name="password" type="password" required placeholder="Entrer le mot de passe">
    <button name="pwd: ChambreDeWill" type="submit">Valider</button>
</form>

<!-- Sons -->
<audio id="bg-music" src="/sounds/musique.mp3" loop></audio>
<audio id="ghost-sound" src="/sounds/monster.mp3" preload="auto"></audio>
<audio id="submit-sound" src="/sounds/correct.mp3" preload="auto"></audio>

<!-- Messages -->
<div id="game-message" class="game-message"></div>

<script>
document.addEventListener('DOMContentLoaded', function(){
    const introWindow = document.getElementById('intro-window');
    const startBtn = document.getElementById('start-btn');
    const bgMusic = document.getElementById('bg-music');
    const ghostSound = document.getElementById('ghost-sound');
    const submitSound = document.getElementById('submit-sound');
    const ghosts = [document.getElementById('ghost-monstre'), document.getElementById('ghost-doc'), document.getElementById('ghost-lampe')];
    const gameMessage = document.getElementById('game-message');
    const passwordForm = document.getElementById('password-form');

    // Lancer musique au premier clic
    document.addEventListener('click', () => { if(bgMusic.paused) bgMusic.play(); }, { once:true });

    // Apparition de la fenÃªtre immersive
    setTimeout(()=> introWindow.style.opacity=1, 500);

    // FantÃ´mes invisibles au dÃ©part
    ghosts.forEach(g => g.style.opacity = 0);

    // Fonction message fantÃ´me
    function showMessage(text){
        gameMessage.textContent = text;
        gameMessage.style.opacity=1;
        setTimeout(()=> gameMessage.style.opacity=0, 3000);
    }

    // Bouton Let's Go
    startBtn.addEventListener('click', ()=>{
        introWindow.style.opacity=0;
        setTimeout(()=>{
            passwordForm.style.display='flex';
            setTimeout(()=> passwordForm.style.opacity=1, 500);
            ghosts.forEach((g,i)=>{
                setTimeout(()=> g.style.opacity=1, 500 + i*1000);
            });
        }, 1000);
    });

    // Clic sur fantÃ´mes pour indices
    ghosts.forEach((g)=>{
        g.addEventListener('click', ()=>{
            ghostSound.currentTime=0; ghostSound.play();
            if(g.id === 'ghost-monstre') showMessage("Regardez ce quâ€™il traÃ®ne derriÃ¨re luiâ€¦ certains dÃ©tails ne sont pas visibles Ã  premiÃ¨re vue.");
            if(g.id === 'ghost-doc') showMessage("Parfois, le mot clÃ© est juste sous vos yeux, dans le code invisible");
            if(g.id === 'ghost-lampe') showMessage("Un simple clic rÃ©vÃ¨le plus quâ€™une illuminationâ€¦ regardez ce qui nâ€™est pas affichÃ©.");
        });
    });

    // Son lors du clic sur Valider
    passwordForm.addEventListener('submit', (e)=>{
        submitSound.currentTime=0;
        submitSound.play();
    });
});
</script>
{% endblock %}
